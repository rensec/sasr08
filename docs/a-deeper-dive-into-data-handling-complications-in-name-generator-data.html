<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 A deeper dive into data handling: complications in name generator data | SaSR 8: Social Network Analysis</title>
  <meta name="description" content="This page contains tutorials for SaSR 8" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="6 A deeper dive into data handling: complications in name generator data | SaSR 8: Social Network Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This page contains tutorials for SaSR 8" />
  <meta name="github-repo" content="rensec/sasr08" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 A deeper dive into data handling: complications in name generator data | SaSR 8: Social Network Analysis" />
  
  <meta name="twitter:description" content="This page contains tutorials for SaSR 8" />
  

<meta name="author" content="Rense Corten &amp; Deni Mazrekaj" />


<meta name="date" content="2025-04-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exponential-random-graphs-modeling.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SaSR8 </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i>Usage</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#credits-and-further-resources"><i class="fa fa-check"></i>Credits and further resources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="tut_data_handling.html"><a href="tut_data_handling.html"><i class="fa fa-check"></i><b>1</b> Handling social network data in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="tut_data_handling.html"><a href="tut_data_handling.html#getting-network-data-into-r-the-igraph-package"><i class="fa fa-check"></i><b>1.1</b> Getting network data into R: the igraph package</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="tut_data_handling.html"><a href="tut_data_handling.html#from-adjacency-matrix-to-igraph-object"><i class="fa fa-check"></i><b>1.1.1</b> From adjacency matrix to igraph object</a></li>
<li class="chapter" data-level="1.1.2" data-path="tut_data_handling.html"><a href="tut_data_handling.html#from-edge-list-to-igraph-object"><i class="fa fa-check"></i><b>1.1.2</b> From edge list to igraph object</a></li>
<li class="chapter" data-level="1.1.3" data-path="tut_data_handling.html"><a href="tut_data_handling.html#from-adjacency-list-to-igraph-object"><i class="fa fa-check"></i><b>1.1.3</b> From adjacency list to igraph object</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="tut_data_handling.html"><a href="tut_data_handling.html#the-reverse-direction-exporting-from-igraph-objects"><i class="fa fa-check"></i><b>1.2</b> The reverse direction: exporting from igraph objects</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="tut_data_handling.html"><a href="tut_data_handling.html#from-igraph-to-adjacency-matrix"><i class="fa fa-check"></i><b>1.2.1</b> From igraph to adjacency matrix</a></li>
<li class="chapter" data-level="1.2.2" data-path="tut_data_handling.html"><a href="tut_data_handling.html#from-igraph-to-edge-list"><i class="fa fa-check"></i><b>1.2.2</b> From igraph to edge list</a></li>
<li class="chapter" data-level="1.2.3" data-path="tut_data_handling.html"><a href="tut_data_handling.html#from-igraph-to-adjacency-list"><i class="fa fa-check"></i><b>1.2.3</b> From igraph to adjacency list</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="tut_data_handling.html"><a href="tut_data_handling.html#getting-network-data-into-r-the-network-package"><i class="fa fa-check"></i><b>1.3</b> Getting network data into R: the network package</a></li>
<li class="chapter" data-level="1.4" data-path="tut_data_handling.html"><a href="tut_data_handling.html#modifying-networks-in-igraph"><i class="fa fa-check"></i><b>1.4</b> Modifying networks in igraph</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html"><i class="fa fa-check"></i><b>2</b> Basic network analysis in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#network-level-a-five-number-summary"><i class="fa fa-check"></i><b>2.1</b> Network level: a “five number summary”</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#size"><i class="fa fa-check"></i><b>2.1.1</b> Size</a></li>
<li class="chapter" data-level="2.1.2" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#density"><i class="fa fa-check"></i><b>2.1.2</b> Density</a></li>
<li class="chapter" data-level="2.1.3" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#components"><i class="fa fa-check"></i><b>2.1.3</b> Components</a></li>
<li class="chapter" data-level="2.1.4" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#diameter-and-distances"><i class="fa fa-check"></i><b>2.1.4</b> Diameter (and distances)</a></li>
<li class="chapter" data-level="2.1.5" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#clustering-coefficient"><i class="fa fa-check"></i><b>2.1.5</b> Clustering Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#individual-level-centrality"><i class="fa fa-check"></i><b>2.2</b> Individual level: centrality</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#degree-centrality"><i class="fa fa-check"></i><b>2.2.1</b> Degree centrality</a></li>
<li class="chapter" data-level="2.2.2" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#betweenness-centrality"><i class="fa fa-check"></i><b>2.2.2</b> Betweenness centrality</a></li>
<li class="chapter" data-level="2.2.3" data-path="basic-network-analysis-in-r.html"><a href="basic-network-analysis-in-r.html#closeness-centrality"><i class="fa fa-check"></i><b>2.2.3</b> Closeness centrality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tut_first_knecht.html"><a href="tut_first_knecht.html"><i class="fa fa-check"></i><b>3</b> Introducing the Knecht data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tut_first_knecht.html"><a href="tut_first_knecht.html#a-first-look-at-the-data"><i class="fa fa-check"></i><b>3.1</b> A first look at the data</a></li>
<li class="chapter" data-level="3.2" data-path="tut_first_knecht.html"><a href="tut_first_knecht.html#assignment"><i class="fa fa-check"></i><b>3.2</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html"><i class="fa fa-check"></i><b>4</b> Networks as causes: Spatial regression analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#constructing-a-spatial-weight-matrix"><i class="fa fa-check"></i><b>4.1</b> Constructing a Spatial Weight Matrix</a></li>
<li class="chapter" data-level="4.2" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#linear-regression-analysis"><i class="fa fa-check"></i><b>4.2</b> Linear Regression Analysis</a></li>
<li class="chapter" data-level="4.3" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#spatial-analysis"><i class="fa fa-check"></i><b>4.3</b> Spatial Analysis</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#morans-i-test"><i class="fa fa-check"></i><b>4.3.1</b> Moran’s I test</a></li>
<li class="chapter" data-level="4.3.2" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#lagrange-multiplier-tests-for-spatial-lag-and-spatial-error-dependencies"><i class="fa fa-check"></i><b>4.3.2</b> Lagrange multiplier tests for spatial lag and spatial error dependencies</a></li>
<li class="chapter" data-level="4.3.3" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#spatial-lag-model"><i class="fa fa-check"></i><b>4.3.3</b> Spatial lag model</a></li>
<li class="chapter" data-level="4.3.4" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#spatial-error-model"><i class="fa fa-check"></i><b>4.3.4</b> Spatial error model</a></li>
<li class="chapter" data-level="4.3.5" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#spatial-autoregressive-combined-model"><i class="fa fa-check"></i><b>4.3.5</b> Spatial autoregressive combined model</a></li>
<li class="chapter" data-level="4.3.6" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#spatial-durbin-model"><i class="fa fa-check"></i><b>4.3.6</b> Spatial Durbin model</a></li>
<li class="chapter" data-level="4.3.7" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#spatial-durbin-error-model"><i class="fa fa-check"></i><b>4.3.7</b> Spatial Durbin error model</a></li>
<li class="chapter" data-level="4.3.8" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#general-nested-model"><i class="fa fa-check"></i><b>4.3.8</b> General nested model</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="networks-as-causes-spatial-regression-analysis.html"><a href="networks-as-causes-spatial-regression-analysis.html#knecht-assignment"><i class="fa fa-check"></i><b>4.4</b> Knecht Assignment</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exponential-random-graphs-modeling.html"><a href="exponential-random-graphs-modeling.html"><i class="fa fa-check"></i><b>5</b> Exponential Random Graphs Modeling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="exponential-random-graphs-modeling.html"><a href="exponential-random-graphs-modeling.html#data-preparation"><i class="fa fa-check"></i><b>5.1</b> Data preparation</a></li>
<li class="chapter" data-level="5.2" data-path="exponential-random-graphs-modeling.html"><a href="exponential-random-graphs-modeling.html#model-estimation"><i class="fa fa-check"></i><b>5.2</b> Model estimation</a></li>
<li class="chapter" data-level="5.3" data-path="exponential-random-graphs-modeling.html"><a href="exponential-random-graphs-modeling.html#goodness-of-fit"><i class="fa fa-check"></i><b>5.3</b> Goodness of fit</a></li>
<li class="chapter" data-level="5.4" data-path="exponential-random-graphs-modeling.html"><a href="exponential-random-graphs-modeling.html#further-resources-on-ergms"><i class="fa fa-check"></i><b>5.4</b> Further resources on ERGMs</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html"><i class="fa fa-check"></i><b>6</b> A deeper dive into data handling: complications in name generator data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#the-case-of-the-missing-ego"><i class="fa fa-check"></i><b>6.1</b> The case of the missing ego</a></li>
<li class="chapter" data-level="6.2" data-path="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#multiple-networks"><i class="fa fa-check"></i><b>6.2</b> Multiple networks</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SaSR 8: Social Network Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-deeper-dive-into-data-handling-complications-in-name-generator-data" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> A deeper dive into data handling: complications in name generator data<a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#a-deeper-dive-into-data-handling-complications-in-name-generator-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In a previous tutorial, we’ve covered processing ‘adjacency list’ data, as typically generated by surveys with name generator questions, as network data. With real-life data, such data sets often have quirks that can create havoc in your data processing procedures if you’re not carefull. In the earlie tutorial, we already discussed one such quirk, namely the presences of isolates. In this tutorial, we cover two more challenges:</p>
<ol style="list-style-type: decimal">
<li>The presence of alters who are missing as respondents (egos);</li>
<li>The processing of multiple subnetworks (in our scenario: school classes) at the same time.</li>
</ol>
<p>Let’s get started.</p>
<p>For practice, we use a toy dataset that was designed for looking just like the Knecht data (but smaller).</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb155-1" tabindex="-1"></a>url1 <span class="ot">&lt;-</span> <span class="st">&quot;https://github.com/rensec/sasr08/raw/main/toy_name_generator_data.csv&quot;</span></span>
<span id="cb155-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb155-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> url1)</span>
<span id="cb155-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb155-3" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>schoolnr)</span></code></pre></div>
<pre><code>## 
## 1a 2b 
##  5  5</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb157-1" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##    schoolnr namenr age friend1 friend2
## 1        1a      1  20       2       4
## 2        1a      2  21       3      NA
## 3        1a      3  25       1      NA
## 4        1a      4  NA      NA      NA
## 5        1a      5  21      NA      NA
## 6        2b      1  22       2       3
## 7        2b      2  24       1       3
## 8        2b      3  NA      NA       4
## 9        2b      4  21       2       5
## 10       2b      5  20       6      NA</code></pre>
<div id="the-case-of-the-missing-ego" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> The case of the missing ego<a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#the-case-of-the-missing-ego" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s start with importing one class, as before:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb159-1" tabindex="-1"></a>cls <span class="ot">&lt;-</span> <span class="st">&quot;1a&quot;</span></span>
<span id="cb159-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb159-2" tabindex="-1"></a>edge_list <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb159-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb159-3" tabindex="-1"></a>  <span class="fu">filter</span>(schoolnr <span class="sc">==</span> cls) <span class="sc">%&gt;%</span> </span>
<span id="cb159-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb159-4" tabindex="-1"></a>  <span class="fu">select</span>(namenr, friend1<span class="sc">:</span>friend2) <span class="sc">%&gt;%</span> </span>
<span id="cb159-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb159-5" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">&quot;namenr&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#make long</span></span>
<span id="cb159-6"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb159-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span> <span class="co"># drop the missings</span></span>
<span id="cb159-7"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb159-7" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span><span class="st">&quot;namenr&quot;</span>, <span class="at">to =</span> <span class="st">&quot;value&quot;</span>, <span class="at">sourcevar=</span> <span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#just nice for interpretation</span></span>
<span id="cb159-8"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb159-8" tabindex="-1"></a>  <span class="fu">relocate</span>(to, <span class="at">.after=</span>from) <span class="co">#move around the columns</span></span>
<span id="cb159-9"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb159-9" tabindex="-1"></a>edge_list</span></code></pre></div>
<pre><code>##   from to sourcevar
## 1    1  2   friend1
## 2    2  3   friend1
## 3    3  1   friend1
## 4    1  4   friend2</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb161-1" tabindex="-1"></a>nodelist <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb161-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb161-2" tabindex="-1"></a>  <span class="fu">filter</span>(schoolnr <span class="sc">==</span> cls) <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb161-3" tabindex="-1"></a>  <span class="fu">select</span>(namenr,age)</span>
<span id="cb161-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb161-4" tabindex="-1"></a></span>
<span id="cb161-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb161-5" tabindex="-1"></a>g1a <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edge_list, <span class="at">vertices =</span> nodelist)</span>
<span id="cb161-6"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb161-6" tabindex="-1"></a><span class="fu">plot</span>(g1a)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>So far, so good.</p>
<p>Now let’s try with the other class:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb162-1" tabindex="-1"></a>cls <span class="ot">&lt;-</span> <span class="st">&quot;2b&quot;</span></span>
<span id="cb162-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb162-2" tabindex="-1"></a>edge_list <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb162-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb162-3" tabindex="-1"></a>  <span class="fu">filter</span>(schoolnr <span class="sc">==</span> cls) <span class="sc">%&gt;%</span> </span>
<span id="cb162-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb162-4" tabindex="-1"></a>  <span class="fu">select</span>(namenr, friend1<span class="sc">:</span>friend2) <span class="sc">%&gt;%</span> </span>
<span id="cb162-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb162-5" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">&quot;namenr&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#make long</span></span>
<span id="cb162-6"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb162-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span> <span class="co"># drop the missings</span></span>
<span id="cb162-7"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb162-7" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span><span class="st">&quot;namenr&quot;</span>, <span class="at">to =</span> <span class="st">&quot;value&quot;</span>, <span class="at">sourcevar=</span> <span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#just nice for interpretation</span></span>
<span id="cb162-8"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb162-8" tabindex="-1"></a>  <span class="fu">relocate</span>(to, <span class="at">.after=</span>from) <span class="co">#move around the columns</span></span>
<span id="cb162-9"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb162-9" tabindex="-1"></a>edge_list</span></code></pre></div>
<pre><code>##   from to sourcevar
## 1    1  2   friend1
## 2    2  1   friend1
## 3    4  2   friend1
## 4    5  6   friend1
## 5    1  3   friend2
## 6    2  3   friend2
## 7    3  4   friend2
## 8    4  5   friend2</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb164-1" tabindex="-1"></a>nodelist <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb164-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb164-2" tabindex="-1"></a>  <span class="fu">filter</span>(schoolnr <span class="sc">==</span> cls) <span class="sc">%&gt;%</span> </span>
<span id="cb164-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb164-3" tabindex="-1"></a>  <span class="fu">select</span>(namenr,age)</span>
<span id="cb164-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb164-4" tabindex="-1"></a></span>
<span id="cb164-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb164-5" tabindex="-1"></a>g2b <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edge_list, <span class="at">vertices =</span> nodelist) </span></code></pre></div>
<pre><code>## Error in graph_from_data_frame(edge_list, vertices = nodelist): Some vertex names in edge list are not listed in vertex data frame</code></pre>
<p><strong><em>Problem:</em></strong> Now this leads to an error, as there is a vertex nominated as friend who is not in the data as an ‘ego’. The <code>igraph</code> function <code>graph_from_data_frame()</code> does not allow this.</p>
<p><strong><em>QUESTION: What is a plausible data collection scenario under which this could happen? </em></strong></p>
<p><strong><em>Solution:</em></strong> We need to fix the node list to include this missing vertex. First let’s create a list of all the vertices that appear in the edge list:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb166-1" tabindex="-1"></a>all_vertices <span class="ot">&lt;-</span> <span class="fu">append</span>(edge_list<span class="sc">$</span>from, edge_list<span class="sc">$</span>to)</span></code></pre></div>
<p>Then, we remove duplicates:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb167-1" tabindex="-1"></a>all_vertices <span class="ot">&lt;-</span> <span class="fu">unique</span>(all_vertices) <span class="sc">%&gt;%</span> </span>
<span id="cb167-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb167-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb167-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb167-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">namenr =</span> <span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb168-1" tabindex="-1"></a>nodelist <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb168-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb168-2" tabindex="-1"></a>  <span class="fu">filter</span>(schoolnr <span class="sc">==</span> cls) <span class="sc">%&gt;%</span> </span>
<span id="cb168-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb168-3" tabindex="-1"></a>  <span class="fu">select</span>(namenr,age, schoolnr) <span class="sc">%&gt;%</span> </span>
<span id="cb168-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb168-4" tabindex="-1"></a>  <span class="fu">merge</span>(all_vertices, <span class="at">by =</span> <span class="st">&quot;namenr&quot;</span>, <span class="at">all.y =</span> T)</span>
<span id="cb168-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb168-5" tabindex="-1"></a></span>
<span id="cb168-6"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb168-6" tabindex="-1"></a>nodelist</span></code></pre></div>
<pre><code>##   namenr age schoolnr
## 1      1  22       2b
## 2      2  24       2b
## 3      3  NA       2b
## 4      4  21       2b
## 5      5  20       2b
## 6      6  NA     &lt;NA&gt;</code></pre>
<p>We now have a node list that includes <em>all</em> the nodes. Obviously, ‘age’ is missing for node 6 in these data, as node 6 was not included as a respondent in the data in the first place. However, ‘schoolnr’ is also missing, even if we <em>know</em> that node 6 was in this class too. So let’s fix that:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb170-1" tabindex="-1"></a>nodelist <span class="ot">&lt;-</span> nodelist <span class="sc">%&gt;%</span> </span>
<span id="cb170-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb170-2" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">schoolnr =</span> cls))</span>
<span id="cb170-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb170-3" tabindex="-1"></a></span>
<span id="cb170-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb170-4" tabindex="-1"></a>nodelist</span></code></pre></div>
<pre><code>##   namenr age schoolnr
## 1      1  22       2b
## 2      2  24       2b
## 3      3  NA       2b
## 4      4  21       2b
## 5      5  20       2b
## 6      6  NA       2b</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb172-1" tabindex="-1"></a>g2b <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edge_list, <span class="at">vertices =</span> nodelist) </span>
<span id="cb172-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb172-2" tabindex="-1"></a><span class="fu">plot</span>(g2b)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
</div>
<div id="multiple-networks" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Multiple networks<a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#multiple-networks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’s try to import the two classes into a network object <em>at once</em>, as if they are a single network.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-1" tabindex="-1"></a>edge_list <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb173-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-2" tabindex="-1"></a>  <span class="fu">select</span>(namenr, friend1<span class="sc">:</span>friend2) <span class="sc">%&gt;%</span> </span>
<span id="cb173-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-3" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">&quot;namenr&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#make long</span></span>
<span id="cb173-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span> <span class="co"># drop the missings</span></span>
<span id="cb173-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span><span class="st">&quot;namenr&quot;</span>, <span class="at">to =</span> <span class="st">&quot;value&quot;</span>, <span class="at">sourcevar=</span> <span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#just nice for interpretation</span></span>
<span id="cb173-6"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-6" tabindex="-1"></a>  <span class="fu">relocate</span>(to, <span class="at">.after=</span>from) <span class="co">#move around the columns</span></span>
<span id="cb173-7"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-7" tabindex="-1"></a></span>
<span id="cb173-8"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-8" tabindex="-1"></a>all_vertices <span class="ot">&lt;-</span> <span class="fu">append</span>(edge_list<span class="sc">$</span>from, edge_list<span class="sc">$</span>to) <span class="sc">%&gt;%</span> </span>
<span id="cb173-9"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-9" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb173-10"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb173-11"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-11" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">namenr =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb173-12"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-12" tabindex="-1"></a></span>
<span id="cb173-13"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-13" tabindex="-1"></a></span>
<span id="cb173-14"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-14" tabindex="-1"></a>nodelist <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb173-15"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-15" tabindex="-1"></a>  <span class="fu">select</span>(namenr,age, schoolnr) <span class="sc">%&gt;%</span> </span>
<span id="cb173-16"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-16" tabindex="-1"></a>  <span class="fu">merge</span>(all_vertices, <span class="at">by =</span> <span class="st">&quot;namenr&quot;</span>, <span class="at">all.y =</span> T, <span class="at">all.x =</span> T)</span>
<span id="cb173-17"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-17" tabindex="-1"></a></span>
<span id="cb173-18"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb173-18" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edge_list, <span class="at">vertices =</span> nodelist) </span></code></pre></div>
<pre><code>## Error in graph_from_data_frame(edge_list, vertices = nodelist): Duplicate vertex names</code></pre>
<p>Houston, we’ve got a problem.</p>
<p>We need to be able to differentiate between the nodes from different classes, both for repondents (“egos”) and nominees (“alters”). Let’s start with the ego, which is the simplest case. We can create a unique student ID by combining the class identifier and the within-class identifier:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb175-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb175-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb175-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id_pupil =</span> <span class="fu">paste0</span>(schoolnr,namenr))</span></code></pre></div>
<p>Now let’s start over, using this new identifier instead of ‘namenr’.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb176-1" tabindex="-1"></a>edge_list <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb176-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb176-2" tabindex="-1"></a>  <span class="fu">select</span>(id_pupil, schoolnr, friend1<span class="sc">:</span>friend2) <span class="sc">%&gt;%</span> </span>
<span id="cb176-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb176-3" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">&quot;id_pupil&quot;</span>,<span class="st">&quot;schoolnr&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co">#make long</span></span>
<span id="cb176-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb176-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span> <span class="co"># drop the missings</span></span>
<span id="cb176-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb176-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span><span class="st">&quot;id_pupil&quot;</span>, <span class="at">to =</span> <span class="st">&quot;value&quot;</span>, <span class="at">sourcevar=</span> <span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#just nice for interpretation</span></span>
<span id="cb176-6"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb176-6" tabindex="-1"></a>  <span class="fu">relocate</span>(to, <span class="at">.after=</span>from) <span class="co">#move around the columns</span></span>
<span id="cb176-7"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb176-7" tabindex="-1"></a>edge_list</span></code></pre></div>
<pre><code>##    from to schoolnr sourcevar
## 1   1a1  2       1a   friend1
## 2   1a2  3       1a   friend1
## 3   1a3  1       1a   friend1
## 4   2b1  2       2b   friend1
## 5   2b2  1       2b   friend1
## 6   2b4  2       2b   friend1
## 7   2b5  6       2b   friend1
## 8   1a1  4       1a   friend2
## 9   2b1  3       2b   friend2
## 10  2b2  3       2b   friend2
## 11  2b3  4       2b   friend2
## 12  2b4  5       2b   friend2</code></pre>
<p>Now we can also create the unique student ID for alters in the ‘to’ column of the edge list:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb178-1" tabindex="-1"></a>edge_list <span class="ot">&lt;-</span> edge_list <span class="sc">%&gt;%</span> </span>
<span id="cb178-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb178-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">to =</span> <span class="fu">paste0</span>(schoolnr,to))</span>
<span id="cb178-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb178-3" tabindex="-1"></a>edge_list</span></code></pre></div>
<pre><code>##    from  to schoolnr sourcevar
## 1   1a1 1a2       1a   friend1
## 2   1a2 1a3       1a   friend1
## 3   1a3 1a1       1a   friend1
## 4   2b1 2b2       2b   friend1
## 5   2b2 2b1       2b   friend1
## 6   2b4 2b2       2b   friend1
## 7   2b5 2b6       2b   friend1
## 8   1a1 1a4       1a   friend2
## 9   2b1 2b3       2b   friend2
## 10  2b2 2b3       2b   friend2
## 11  2b3 2b4       2b   friend2
## 12  2b4 2b5       2b   friend2</code></pre>
<p>The result is a neat list of within-class ties. We continue with creating the node list:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb180-1" tabindex="-1"></a>all_vertices <span class="ot">&lt;-</span> <span class="fu">append</span>(edge_list<span class="sc">$</span>from, edge_list<span class="sc">$</span>to) <span class="sc">%&gt;%</span> </span>
<span id="cb180-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb180-2" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb180-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb180-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb180-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb180-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id_pupil =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb180-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb180-5" tabindex="-1"></a></span>
<span id="cb180-6"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb180-6" tabindex="-1"></a></span>
<span id="cb180-7"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb180-7" tabindex="-1"></a>nodelist <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb180-8"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb180-8" tabindex="-1"></a>  <span class="fu">select</span>(id_pupil,age, schoolnr) <span class="sc">%&gt;%</span> </span>
<span id="cb180-9"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb180-9" tabindex="-1"></a>  <span class="fu">merge</span>(all_vertices, <span class="at">by =</span> <span class="st">&quot;id_pupil&quot;</span>, <span class="at">all.y =</span> T, <span class="at">all.x =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb181-1" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edge_list, <span class="at">vertices =</span> nodelist) </span>
<span id="cb181-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb181-2" tabindex="-1"></a><span class="fu">plot</span>(g2, <span class="at">vertex.color =</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g2)<span class="sc">$</span>schoolnr<span class="sc">==</span><span class="st">&quot;1a&quot;</span>, <span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<p>Almost correct! The one thing to fix is that now we don’t have the schoolnr for node 2b6. The approach that we used earlier doesn’t work now (why not?), but recall that we already have schoolnr for each edge in ‘edge_list’. We use that to keep schoolnr with the list of all vertices (all_vertices) and keep it in the merge with the node list. The method for constructing <code>all_vertices</code> is a little different now.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-1" tabindex="-1"></a>all_vertices <span class="ot">&lt;-</span> edge_list <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id_pupil =</span> from, schoolnr) <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-3" tabindex="-1"></a>  <span class="fu">bind_rows</span>(edge_list <span class="sc">%&gt;%</span></span>
<span id="cb182-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-4" tabindex="-1"></a>        <span class="fu">select</span>(<span class="at">id_pupil =</span> to, schoolnr)) <span class="sc">%&gt;%</span></span>
<span id="cb182-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-5" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb182-6"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-6" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">schoolnr_from_edges =</span> schoolnr)</span>
<span id="cb182-7"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-7" tabindex="-1"></a></span>
<span id="cb182-8"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-8" tabindex="-1"></a>nodelist <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb182-9"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-9" tabindex="-1"></a>  <span class="fu">select</span>(id_pupil,age, schoolnr) <span class="sc">%&gt;%</span> </span>
<span id="cb182-10"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb182-10" tabindex="-1"></a>  <span class="fu">merge</span>(all_vertices, <span class="at">by =</span> <span class="st">&quot;id_pupil&quot;</span>, <span class="at">all.y =</span> T, <span class="at">all.x =</span> T)</span></code></pre></div>
<p>We now replace any NA’s in schoolnr with the value in schoolnr_from_edges. For tidiness, we remove schoolnr_from_edges as we don’t need it to be imported in our network object (of course there may be scenarios where you may want to keep it).</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb183-1" tabindex="-1"></a>nodelist <span class="ot">&lt;-</span> nodelist <span class="sc">%&gt;%</span> </span>
<span id="cb183-2"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb183-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">schoolnr =</span> <span class="fu">coalesce</span>(schoolnr,schoolnr_from_edges)) <span class="sc">%&gt;%</span> </span>
<span id="cb183-3"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb183-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>schoolnr_from_edges)</span>
<span id="cb183-4"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb183-4" tabindex="-1"></a></span>
<span id="cb183-5"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb183-5" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edge_list, <span class="at">vertices =</span> nodelist) </span>
<span id="cb183-6"><a href="a-deeper-dive-into-data-handling-complications-in-name-generator-data.html#cb183-6" tabindex="-1"></a><span class="fu">plot</span>(g2, <span class="at">vertex.color =</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g2)<span class="sc">$</span>schoolnr<span class="sc">==</span><span class="st">&quot;1a&quot;</span>, <span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<p>Done!</p>

</div>
</div>







            </section>

          </div>
        </div>
      </div>
<a href="exponential-random-graphs-modeling.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/more_name_generator_handling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
